<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/gair_group_docs/assets/css/just-the-docs-default.css"><link rel="shortcut icon" href="/gair_group_docs/favicon.ico" type="image/x-icon"> <script type="text/javascript" src="/gair_group_docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/gair_group_docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Conformational Entropy | Gair Group Docs</title><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Conformational Entropy" /><meta property="og:locale" content="en_US" /><meta name="description" content="Documents for the Gair Group" /><meta property="og:description" content="Documents for the Gair Group" /><link rel="canonical" href="http://localhost:4000/gair_group_docs/page/examples/entropy.html" /><meta property="og:url" content="http://localhost:4000/gair_group_docs/page/examples/entropy.html" /><meta property="og:site_name" content="Gair Group Docs" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Conformational Entropy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documents for the Gair Group","headline":"Conformational Entropy","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/gair_group_docs/assets/images/gair-group-logo.png"}},"url":"http://localhost:4000/gair_group_docs/page/examples/entropy.html"}</script><link rel="shortcut icon" href="/gair_group_docs/assets/images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/gair_group_docs/assets/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/gair_group_docs/assets/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/gair_group_docs/assets/images/favicon-16x16.png"><link href="/gair_group_docs/assets/css/fontawesome/css/all.css" rel="stylesheet"><link rel="stylesheet" href="/gair_group_docs/assets/css/bootstrap-grid.css"><link rel="stylesheet" href="/gair_group_docs/assets/css/bootstrap-utilities.css"><link rel="stylesheet" href="/gair_group_docs/assets/css/customstyles.css"><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/gair_group_docs/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/gair_group_docs/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/computation" class="nav-list-link">Computation</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/computation/setup.html" class="nav-list-link">Setup ORCA</a><ul class="nav-list"></ul><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/computation/code-free-dft.html" class="nav-list-link">Code-Free DFT</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/computation/coords.html" class="nav-list-link">File Formats</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples" class="nav-list-link">Examples and Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_1.html" class="nav-list-link">Example 1</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_2.html" class="nav-list-link">Example 2</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_3.html" class="nav-list-link">Example 3</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_4.html" class="nav-list-link">Example 4</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_5.html" class="nav-list-link">Example 5</a><li class="nav-list-item active"><a href="http://localhost:4000/gair_group_docs/page/examples/entropy.html" class="nav-list-link active">Conformational Entropy</a><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/publication" class="nav-list-link">Publication Examples</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_1.html" class="nav-list-link">TS Conformers</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_2.html" class="nav-list-link">Metal-organic Systems</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_3.html" class="nav-list-link">TYR on graphene</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/qcg" class="nav-list-link">QCG Examples</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_1.html" class="nav-list-link">QCG Example 1</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_2.html" class="nav-list-link">QCG Example 2</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_3.html" class="nav-list-link">QCG Example 3</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_4.html" class="nav-list-link">QCG Example 4</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_restart.html" class="nav-list-link">Restarting QCG</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/mecp" class="nav-list-link">MECP Calculations</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/mecp/mecp_opt.html" class="nav-list-link">MECP Optimization</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/mecp/mecp_screen.html" class="nav-list-link">MECP Screening</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/utilities" class="nav-list-link">Utility Tools</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_1.html" class="nav-list-link">Ensemble Optimization</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_2.html" class="nav-list-link">Calculating RMSDs</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_3.html" class="nav-list-link">Topology Check</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_4.html" class="nav-list-link"><code>thermo</code> Calculations</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_5.html" class="nav-list-link">Calculate <i>S</i><sub>msRRHO</sub></a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_6.html" class="nav-list-link">xTB Nanoreactor</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/about" class="nav-list-link">About</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/about/contact.html" class="nav-list-link">Contact</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/about/about-docs.html" class="nav-list-link">About the Documentation</a></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Gair Group Docs" aria-label="Search Gair Group Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/gair-group" class="site-button" > <i class="fa-brands fa-github"></i>&nbsp;Gair Group Docs on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/gair_group_docs/page/examples">Examples and Guides</a><li class="breadcrumb-nav-list-item"><span>Conformational Entropy</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="no_toc" id="conformational-entropy"> <a href="#conformational-entropy" class="anchor-heading" aria-labelledby="conformational-entropy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conformational Entropy</h1><p class="fs-6 fw-300">A guide to the calculation of conformational entropies with CREST.</p><hr /><div class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> <b>Important:</b> CREST’s conformational entropy procedure currently does not work well for non-covalent systems and should be considered mainly for covalent molecular systems.</div><hr /><h2 id="conformational-entropy-overview"> <a href="#conformational-entropy-overview" class="anchor-heading" aria-labelledby="conformational-entropy-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conformational Entropy Overview</h2><p class="text-justify">The <em>conformation</em> (or <em>configurational</em>) entropy mode of CREST was introduced with <a href="https://doi.org/10.1039/D1SC00621E"><em>Chem. Sci.</em>, <strong>2021</strong>, <em>12</em>, 6551-6568</a>. It is based on the idea to provide absolute molecular entropies of systems from a single DFT entropy calculation for the lowest conformer and correct this by the conformational entropy contribution of the ensemble at a cheaper FF or SQM level.</p>\[S_\text{abs} = S_\text{rot,trans,vib}^\text{DFT} + S_\text{conf}^\text{SQM}\]<p>The conformational term can be further separated into</p>\[S_\text{conf} = S'_\text{conf} + \bar{S}_\text{msRRHO}\]<p>where the <em>averaged S</em><sub>msRRHO</sub> term</p>\[\bar{S}_\text{msRRHO}=\left(\sum p_i S_\text{msRRHO,i}\right)-S_\text{msRRHO,ref}\]<p class="text-justify">describes the Boltzmann population-averaged trans., rot., and vib. entropy contributions of the conformer ensemble at SQM level (corrected by the value for the reference structure in order to be additive). The “pure” confromational contribution</p>\[S'_\text{conf} = R\left( \ln\sum g'_i e^{-E_i\beta} +\frac{\sum g'_i (E_i\beta) e^{-E_i\beta}}{\sum g'_i e^{-E_i\beta}}\right)\]<p class="text-justify">corresponds to the Gibbs-Shannon entropy and depends <em>only</em> on the ensembles’ energy distribution. It is due to this term that the conformational entropy has an inherent dependence on the respective potential energy surface at a given level of theory.</p><p>In the above mentioned publication, a four step procedure was proposed for the calculation of <em>S</em><sub>abs</sub>:</p><ol><li>Find the lowest conformer (ideally at a DFT level, which requires refinement).<li>Calculate harmonic frequencies for the lowest conformer at DFT level and get the \(S_\text{rot,trans,vib}^\text{DFT}\) contribution.<li>Calculate \(S_\text{conf}\) with CREST at a SQM or FF level.<li>Add the entropies from step 2 and 3 to obtain <em>S</em><sub>abs</sub>.</ol><p>Some comments to these four steps are presented in the following. For options specific to the entropy mode, such as defining a temperature range, see the <a href="../documentation/keywords.html#entropy-mode-settings"><strong>Keyword Documentation</strong> <i class="fa-solid fa-book"></i></a>.</p><hr /><h3 id="1-finding-the-lowest-conformer"> <a href="#1-finding-the-lowest-conformer" class="anchor-heading" aria-labelledby="1-finding-the-lowest-conformer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Finding the lowest conformer</h3><p class="text-justify">Run the CREST standard procedure (<em>e.g.</em> see <a href="./example_1.html">Example 1</a>) and DFT refine your ensemble to identify the lowest conformer. The refinement could be done with <a href="https://xtb-docs.readthedocs.io/en/latest/CENSO_docs/censo.html">CENSO</a> or just some script of your own. You will likely need access to some QM software of your choice that is capable of performing DFT calculations for the refinement.</p><h3 id="2-dft-frequency-calculation"> <a href="#2-dft-frequency-calculation" class="anchor-heading" aria-labelledby="2-dft-frequency-calculation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. DFT frequency calculation</h3><p class="text-justify">This has also to be done by a QM software package of your choice. Most of those software packages should offer the ability to compute harmonic frequencies. In the original publication we employed the B97-3c and B3LYP-D3/def2-TZVP methods. The respective partition functions were evaluated in a <em>modified and scaled rigid-rotor harmonic-oscillator</em> (msRRHO) approximation that was adjusted <strong><em>specifically</em></strong> for the calculation of absolute molecular entropies. Since it can not be ensured that your QM software has the scaling and the modification (a specific interpolation for low frequency normal modes) implemented, CREST offers a standalone tool for this evaluation. See <a href="./utilities/utils_4.html">Example: <code class="language-plaintext highlighter-rouge">thermo</code></a>. Use <code class="language-plaintext highlighter-rouge">--sthr 25.0</code> in order to be consistent with the publication and choose a scaling factor (<code class="language-plaintext highlighter-rouge">--fscal</code>) appropriate to your DFT functional.</p><h3 id="3-crest-entropy-calculation"> <a href="#3-crest-entropy-calculation" class="anchor-heading" aria-labelledby="3-crest-entropy-calculation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. CREST entropy calculation</h3><p>Initiate the conformational entropy calculation in CREST by</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crest &lt;input&gt; <span class="nt">--entropy</span> <span class="o">[</span>other options]
</code></pre></div></div><p class="text-justify">where <code class="language-plaintext highlighter-rouge">&lt;input&gt;</code> is your DFT-refined lowest conformer from steps 1/2. The usual method selection options such as the GFN method or implicit solvation are available as <code class="language-plaintext highlighter-rouge">[other options]</code>, but <strong><em>special runtypes</em></strong> such as <code class="language-plaintext highlighter-rouge">--nci</code> or <code class="language-plaintext highlighter-rouge">--quick</code> <strong><em>are incopatible with the entropy mode</em></strong>.</p><p class="text-justify">This will calculate the additive terms \(S'_\text{conf}\) and \(\bar{S}_\text{msRRHO}\) at the SQM or FF level. As described in the publication, the separate sampling algorithm is necessary to enable the entropy extrapolation. In theory, steps 1 and 3 could be combined, but note that some slight deviations (mainly with regards to \(\bar{S}_\text{msRRHO}\)) will be the result.</p><p>For a more statistically secure result it is also advisable to repeat the entropy calculation of step 3 several times and average the results.</p><h3 id="4-add-everything-up"> <a href="#4-add-everything-up" class="anchor-heading" aria-labelledby="4-add-everything-up"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Add everything up</h3><p>The final printout of step 3 will summarize the conformational quantities for different temperatures.</p><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel" style="font-size:10px"><pre id="codecell">
[....]

 ----------------------
 TEMPERATURE DEPENDENCE
 ----------------------
 
 Final CONFORMATIONAL quantities at given T:
       T/K        S(total)           Cp(T)     [H(T)-H(0)]        G(total)
   -----------------------------------------------------------------------
    278.15        5.604582        1.913630        0.495345       -1.063569
    288.15        5.683492        1.904816        0.504876       -1.132822
    298.15        5.757901        1.895427        0.514176       -1.202542
    308.15        5.828199        1.885206        0.523259       -1.272700
    318.15        5.894721        1.873990        0.532131       -1.343274
    328.15        5.957760        1.861695        0.540797       -1.414242
    338.15        6.017572        1.848290        0.549259       -1.485583
    348.15        6.074384        1.833788        0.557518       -1.557279
    358.15        6.128396        1.818233        0.565573       -1.629313
    368.15        6.179791        1.801689        0.573422       -1.701668
    378.15        6.228732        1.784234        0.581066       -1.774329
   -----------------------------------------------------------------------
   S and Cp in cal/mol*K; H and G in kcal/mol
   G(total) is the ensemble free energy (H-T*S) and S(total) = S(conf,extrapol.) + δSrrho
 
 ------------------------------------------
 | FINAL MOLECULAR ENTROPY AT T= 298.15 K |
 ------------------------------------------
   Sconf   =          4.851731
 + δSrrho  =          0.906170
 ----------------------------------------
 = S(total)  =          5.757901
 
   H(T)-H(0) =          0.514176
   G         =         -1.716718   (-T*S)
 ----------------------------------------
 = G(total)  =         -1.202542  (H-T*S)
 
   Cp(total) =          1.895427
 
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div><p class="text-justify">Herein, <code class="language-plaintext highlighter-rouge">Sconf</code> corresponds to \(S'_\text{conf}\) while <code class="language-plaintext highlighter-rouge">δSrrho</code> corresponds to \(\bar{S}_\text{msRRHO}\). Their sum, <code class="language-plaintext highlighter-rouge">S(total)</code>, corresponds to the additive \(S_\text{conf}^\text{SQM}\) from above and can be added to \(S_\text{rot,trans,vib}^\text{DFT}\) from step 2. Note that the entropy and heat capacity are given in <strong>cal mol<sup>-1</sup>K<sup>-1</sup></strong> while the enthalpy and free energy are provided in <strong>kcal mol<sup>-1</sup></strong>.</p><hr><footer><p><a href="#top" id="back-to-top">Back to top <i class='fa-solid fa-circle-up'></i></a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022-2023 Joe Gair.</p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
