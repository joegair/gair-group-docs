<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/gair_group_docs/assets/css/just-the-docs-default.css"><link rel="shortcut icon" href="/gair_group_docs/favicon.ico" type="image/x-icon"> <script type="text/javascript" src="/gair_group_docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/gair_group_docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Example 4 | Gair Group Docs</title><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Example 4" /><meta property="og:locale" content="en_US" /><meta name="description" content="Documents for the Gair Group" /><meta property="og:description" content="Documents for the Gair Group" /><link rel="canonical" href="http://localhost:4000/gair_group_docs/page/examples/example_4.html" /><meta property="og:url" content="http://localhost:4000/gair_group_docs/page/examples/example_4.html" /><meta property="og:site_name" content="Gair Group Docs" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Example 4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documents for the Gair Group","headline":"Example 4","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/gair_group_docs/assets/images/gair-group-logo.png"}},"url":"http://localhost:4000/gair_group_docs/page/examples/example_4.html"}</script><link rel="shortcut icon" href="/gair_group_docs/assets/images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/gair_group_docs/assets/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/gair_group_docs/assets/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/gair_group_docs/assets/images/favicon-16x16.png"><link href="/gair_group_docs/assets/css/fontawesome/css/all.css" rel="stylesheet"><link rel="stylesheet" href="/gair_group_docs/assets/css/bootstrap-grid.css"><link rel="stylesheet" href="/gair_group_docs/assets/css/bootstrap-utilities.css"><link rel="stylesheet" href="/gair_group_docs/assets/css/customstyles.css"><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/gair_group_docs/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/gair_group_docs/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/computation" class="nav-list-link">Computation</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/computation/setup.html" class="nav-list-link">Setup ORCA</a><ul class="nav-list"></ul><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/computation/code-free-dft.html" class="nav-list-link">Code-Free DFT</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/computation/coords.html" class="nav-list-link">File Formats</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples" class="nav-list-link">Examples and Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_1.html" class="nav-list-link">Example 1</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_2.html" class="nav-list-link">Example 2</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_3.html" class="nav-list-link">Example 3</a><li class="nav-list-item active"><a href="http://localhost:4000/gair_group_docs/page/examples/example_4.html" class="nav-list-link active">Example 4</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/example_5.html" class="nav-list-link">Example 5</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/examples/entropy.html" class="nav-list-link">Conformational Entropy</a><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/publication" class="nav-list-link">Publication Examples</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_1.html" class="nav-list-link">TS Conformers</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_2.html" class="nav-list-link">Metal-organic Systems</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/publication/example_3.html" class="nav-list-link">TYR on graphene</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/qcg" class="nav-list-link">QCG Examples</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_1.html" class="nav-list-link">QCG Example 1</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_2.html" class="nav-list-link">QCG Example 2</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_3.html" class="nav-list-link">QCG Example 3</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_4.html" class="nav-list-link">QCG Example 4</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/qcg/example_restart.html" class="nav-list-link">Restarting QCG</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/examples/mecp" class="nav-list-link">MECP Calculations</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/mecp/mecp_opt.html" class="nav-list-link">MECP Optimization</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/mecp/mecp_screen.html" class="nav-list-link">MECP Screening</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/utilities" class="nav-list-link">Utility Tools</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_1.html" class="nav-list-link">Ensemble Optimization</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_2.html" class="nav-list-link">Calculating RMSDs</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_3.html" class="nav-list-link">Topology Check</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_4.html" class="nav-list-link"><code>thermo</code> Calculations</a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_5.html" class="nav-list-link">Calculate <i>S</i><sub>msRRHO</sub></a><li class="nav-list-item "> <a href="http://localhost:4000/gair_group_docs/page/examples/utilities/utils_6.html" class="nav-list-link">xTB Nanoreactor</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gair_group_docs/page/about" class="nav-list-link">About</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/about/contact.html" class="nav-list-link">Contact</a><li class="nav-list-item "><a href="http://localhost:4000/gair_group_docs/page/about/about-docs.html" class="nav-list-link">About the Documentation</a></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Gair Group Docs" aria-label="Search Gair Group Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/gair-group" class="site-button" > <i class="fa-brands fa-github"></i>&nbsp;Gair Group Docs on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/gair_group_docs/page/examples">Examples and Guides</a><li class="breadcrumb-nav-list-item"><span>Example 4</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="no_toc" id="example-4"> <a href="#example-4" class="anchor-heading" aria-labelledby="example-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 4</h1><p class="fs-6 fw-300">A guide to <i>constrained</i> conformational sampling with CREST.</p><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#constrained-conformational-sampling" id="markdown-toc-constrained-conformational-sampling">Constrained conformational sampling</a><li><a href="#fixing-of-entire-substructure-parts" id="markdown-toc-fixing-of-entire-substructure-parts">Fixing of entire substructure parts</a><ol><li><a href="#semi-automated-preparation-of-a-constraint-input" id="markdown-toc-semi-automated-preparation-of-a-constraint-input">Semi-automated preparation of a constraint input</a></ol><li><a href="#automated-bond-constraints" id="markdown-toc-automated-bond-constraints">Automated bond constraints</a></ol><hr /><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Warning:</b> Constraints that are included via CREST’s <code class="language-plaintext highlighter-rouge">--cinp</code> command will generally be present for <strong>ALL</strong> <code class="language-plaintext highlighter-rouge">xtb</code> calculations; MD, MTD, optimizations, and singlepoints. Be careful not to bias your calculation too strongly and choose <em>moderate</em> force constants!</div><hr /><h2 id="constrained-conformational-sampling"> <a href="#constrained-conformational-sampling" class="anchor-heading" aria-labelledby="constrained-conformational-sampling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Constrained conformational sampling</h2><p class="text-justify">CREST’s conformational search relies on the quality of the underlying level of theory. Since we are choosing a SQM method (GFN<em>n</em>-xTB), it is possible for the system to freely form and break bonds. While it was shown in <a href="example_2.html#handling-topology-in-cregen">Example 2</a> how to handle the resulting topology mismatches in the sorting algorithm, in some occasions it might be required for the user to constrain certain parts of the geometry. In CREST this is possible by passing the respective <strong>constraints as a separate file</strong> to <code class="language-plaintext highlighter-rouge">xtb</code>.</p><p class="text-justify">A typical example are metal-organic compounds that can be sigificantly distorted at the GFN<em>n</em>-xTB level. Here, certain bond lengths or angles can be constrained in order to avoid this. An even simpler example are small non-covalent complexes. As was noted in <a href="example_3.html">Example 3</a>, the MTD bias potential leads to dissociation of such non-covalently bound molecules. Instead of employing a wall potential like in the previous example, one can simply constrain some interatomic distances. This can be shown, for example for the methanol-acetamide complex from the <a href="https://doi.org/10.1021/ct2002946">S66 benchmark set</a>.</p><figure><img class="docimage" src="/gair_group_docs/assets/images/example-4-1.png" alt="methanol-acetamide complex" style="max-width: 400px" oncontextmenu="return false;" /><figcaption>Non-covalent complex of methanol and acetamide, taken from the S66 benchmark set.</figcaption></figure><div class="alert alert-success" role="alert"><i class="fa-solid fa-square-check"></i> <b>Tip:</b> In principle, the constraining of <em>any</em> interatomic <strong>distance</strong>, <strong>angle</strong>, or <strong>dihedral angle</strong> is possible.</div><p class="text-justify">In the respective <code class="language-plaintext highlighter-rouge">constraints.inp</code> file, all constraints have to be specified in the <code class="language-plaintext highlighter-rouge">xtb</code> format. See the <a href="https://xtb-docs.readthedocs.io/en/latest/xcontrol.html#fixing-constraining-and-confining"><code class="language-plaintext highlighter-rouge">xtb</code> <strong>Detailed Input</strong> documentation</a>. For the methanol-acetamide example, the interatomic distance between the hyrdogen atom (2) and the oxygen atom (12) is constrained by an harmonic potential (force constant in atomic units, 0.25 <em>E</em><sub>h</sub>/Bohr<sup>2</sup>) to a value of 1.85 Ångström. The input files and the CREST command are given as</p><p></p><div class="tab card"> <button class="tablinks tab-id-1" onclick="openTabId(event, 'tab-1-1', 'tab-id-1')" id="open-1"><i class="fa-solid fa-code"></i> <code>command</code></button> <button class="tablinks tab-id-1" onclick="openTabId(event, 'tab-1-2', 'tab-id-1')"><i class="fa-solid fa-file-code"></i> <code>struc.xyz</code></button> <button class="tablinks tab-id-1" onclick="openTabId(event, 'tab-1-3', 'tab-id-1')"><i class="fa-solid fa-file-code"></i> <code>constraints.inp</code></button></div><div id="tab-1-1" class="tabcontent tab-id-1" style="text-align:justify"><div class="highlight-rel"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight"><pre class="highlight highlight-rel"><code>crest struc.xyz <span class="nt">--cinp</span> constraints.inp</code></pre></div></div><button class="btn copybtn fa-solid fa-copy" style="font-size:12px" onclick="copyCode2(event)"></button></div></div><div id="tab-1-2" class="tabcontent tab-id-1" style="text-align:justify"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel" style="font-size:10px"><pre id="codecell">
  18
  
 O         -2.3458343675       -0.5958980711       -1.0986703785
 H         -1.4259310467       -0.7659191523       -0.8402268081
 C         -3.1592303454       -1.1201985353       -0.0717185983
 H         -4.1945481644       -0.9177347321       -0.3348616664
 H         -3.0448003417       -2.2008537204        0.0422726914
 H         -2.9616880843       -0.6545221185        0.8983810538
 C         -0.1635664885        1.5241966295        0.3660367684
 H          0.3428271404        2.4856457127        0.3311664119
 H         -0.5741106118        1.3780607546        1.3639134085
 H         -0.9932142903        1.5146833556       -0.3354687645
 C          0.7520638942        0.3692578108        0.0501205567
 O          0.3278691014       -0.7506529824       -0.2349609814
 N          2.0782008097        0.6309820886        0.1093199208
 H          2.3762132585        1.5414102214        0.4070071098
 C          3.0606068433       -0.4091292185       -0.1134239002
 H          2.7040496555       -1.0600665402       -0.9056008595
 H          4.0009760815        0.0443946174       -0.4119376006
 H          3.2201169562       -1.0136561201        0.7786516358
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div></div><div id="tab-1-3" class="tabcontent tab-id-1" style="text-align:justify"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel"><pre id="codecell">
$constrain
  force constant=0.25
  distance: 2, 12, 1.85
$end
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div></div><script> document.getElementById("open-1").click(); </script><p class="text-justify">The respective conformational search provides an ensemble of non-covalently bound methanol-acetamide structures which all have a H(2)-O(12) distance close to 1.85 Å.</p><hr /><h2 id="fixing-of-entire-substructure-parts"> <a href="#fixing-of-entire-substructure-parts" class="anchor-heading" aria-labelledby="fixing-of-entire-substructure-parts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Fixing of entire substructure parts</h2><figure><img class="docimage" src="/gair_group_docs/assets/images/example-4-2.png" alt="Side-chain conformational sampling" oncontextmenu="return false;" /><figcaption>An example where constraining an entire part of the structure is necessary: Sampling of side-chain conformations. This system was investigated with CREST in <a href="https://doi.org/10.1039/D0CP04920D">Phys. Chem. Chem. Phys., 2020, 22, 24282- 24290.</a></figcaption></figure><p class="text-justify">Sometimes it is necessary to fix entire parts of the structure. While <strong>complete freezing of atoms is not possible in CREST</strong>, putting a <strong><em>constraint on a large part of the substructure is possible</em></strong>. In principle, the procedure is identical to the one <a href="#constrained-conformational-sampling">above <i class="fa-solid fa-circle-up"></i></a>, but needs some simple additions.</p><p class="text-justify">As an example, a fictional system consisting out of a linear <em>n</em>-octane chain with a diglycine substituent is calculated. Here, the <em>entire</em> <em>n</em>-octane chain shall be fixed, so that it remains linear.</p><figure><img class="docimage" src="/gair_group_docs/assets/images/example-4-3.png" alt="Side-chain conformational sampling example" style="max-width: 400px" oncontextmenu="return false;" /><figcaption>A fictional example for finding side-chain conformations. The linear n-octane chain (in orange) is fixed. Different side-chain conformers of the diglycine substituent are shown in transparent blue.</figcaption></figure><p>To prepare the calculation, several things have to be done:</p><ol><li>A constraints file has to be created<li>In this file, all atoms that shall be fixed must be added to the <code class="language-plaintext highlighter-rouge">$constrain</code> block with the <code class="language-plaintext highlighter-rouge">atoms:</code> keyword<li>An <em>unchanged</em> reference geometry (= a copy of your input geometry) has to be added in the calculation directory and specified in the <code class="language-plaintext highlighter-rouge">$constrain</code> block with the <code class="language-plaintext highlighter-rouge">reference=</code> keyword<li>All atoms that are <em>not</em> constrained (= your side chain to be sampled) must be added to the <code class="language-plaintext highlighter-rouge">$metadyn</code> block with the <code class="language-plaintext highlighter-rouge">atoms:</code> keyword<li>The command line argument <code class="language-plaintext highlighter-rouge">--subrmsd</code> should be used in the CREST call<li>(Optional) the MD/MTD time step should be reduced with <code class="language-plaintext highlighter-rouge">--tstep &lt;REAL&gt;</code></ol><p>The final calculation and respective files will look like this:</p><p></p><div class="tab card"> <button class="tablinks tab-id-2" onclick="openTabId(event, 'tab-2-1', 'tab-id-2')" id="open-2"><i class="fa-solid fa-code"></i> <code>command</code></button> <button class="tablinks tab-id-2" onclick="openTabId(event, 'tab-2-2', 'tab-id-2')"><i class="fa-solid fa-file-code"></i> <code>fictional.xyz</code></button> <button class="tablinks tab-id-2" onclick="openTabId(event, 'tab-2-3', 'tab-id-2')"><i class="fa-solid fa-file-code"></i> <code>constraints.inp</code></button> <button class="tablinks tab-id-2" onclick="openTabId(event, 'tab-2-4', 'tab-id-2')"><i class="fa-solid fa-file-circle-check"></i> <code>output</code></button></div><div id="tab-2-1" class="tabcontent tab-id-2" style="text-align:justify"><div class="highlight-rel"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight"><pre class="highlight highlight-rel"><code>crest fictional.xyz <span class="nt">--cinp</span> constraints.inp <span class="nt">--subrmsd</span></code></pre></div></div><button class="btn copybtn fa-solid fa-copy" style="font-size:12px" onclick="copyCode2(event)"></button></div></div><div id="tab-2-2" class="tabcontent tab-id-2" style="text-align:justify"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel" style="font-size:10px"><pre id="codecell">
  41
  
 C          1.0144800000       -0.0609700000       -0.0825900000
 C          2.5333400000       -0.0608400000       -0.0710600000
 C          3.0664700000       -0.3643600000        1.3256100000
 C          4.5908500000       -0.3677000000        1.3420700000
 C          5.1165500000       -0.6739300000        2.7411100000
 C          6.6413400000       -0.6756000000        2.7574300000
 C          7.1736700000       -0.9813000000        4.1534600000
 C          8.6899400000       -0.9817400000        4.1630900000
 H          0.6423500000        0.1573500000       -1.0871300000
 H          0.6205000000        0.6974700000        0.6016700000
 H          0.6236000000       -1.0367300000        0.2236500000
 H          2.9003600000        0.9164900000       -0.4063100000
 H          2.9034800000       -0.8084900000       -0.7825300000
 H          2.6926100000       -1.3400300000        1.6597300000
 H          2.6921400000        0.3848400000        2.0340900000
 H          4.9664500000        0.6088800000        1.0113000000
 H          4.9674500000       -1.1157300000        0.6334000000
 H          4.7415200000       -1.6506000000        3.0706100000
 H          4.7391300000        0.0736300000        3.4494600000
 H          7.0139700000        0.3012200000        2.4251500000
 H          7.0160900000       -1.4228100000        2.0470400000
 H          6.8073200000       -1.9587400000        4.4877200000
 H          6.8053100000       -0.2343600000        4.8660200000
 C          9.2154250000       -1.9852880000        3.2579620000
 H          9.0652900000       -1.2016200000        5.1680800000
 H          9.0847000000       -0.0064100000        3.8597300000
 N         10.6547150000       -1.9569240000        3.2931620000
 C          8.7477200000       -3.2959450000        3.6653100000
 H          8.8728820000       -1.7760900000        2.2456280000
 H         11.0200180000       -2.6545630000        2.6639420000
 H         10.9798510000       -1.0457920000        3.0099850000
 O          9.0775760000       -4.2852730000        3.0322020000
 N          7.8939040000       -3.4298300000        4.8171220000
 H          7.7233110000       -2.5201690000        5.2164720000
 C          6.6427270000       -4.0223990000        4.4208670000
 C          5.7829810000       -4.1572140000        5.5806780000
 H          6.1579230000       -3.3865210000        3.6815810000
 H          6.8270280000       -5.0051580000        3.9894270000
 O          4.5047420000       -4.7116320000        5.4438410000
 O          6.1735030000       -3.7875090000        6.6757630000
 H          4.0745330000       -4.7284110000        6.2906810000
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div></div><div id="tab-2-3" class="tabcontent tab-id-2" style="text-align:justify"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel"><pre id="codecell">
$constrain
  atoms: 1-26
  force constant=0.5
  reference=coord.ref
$metadyn
  atoms: 27-41
$end
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div></div><div id="tab-2-4" class="tabcontent tab-id-2" style="text-align:justify"><div class="language-plaintext highlighter-rouge highlight-rel"><div class="highlight highlight-rel" style="font-size:10px"><pre id="codecell">
 
       ==============================================
       |                                            |
       |                 C R E S T                  |
       |                                            |
       |  Conformer-Rotamer Ensemble Sampling Tool  |
       |          based on the GFN methods          |
       |             P.Pracht, S.Grimme             |
       |          Universitaet Bonn, MCTC           |
       ==============================================
       Version 2.12,   Thu 19. Mai 16:32:32 CEST 2022
  Using the xTB program. Compatible with xTB version 6.4.0
 
   Cite work conducted with this code as

   • P.Pracht, F.Bohle, S.Grimme, PCCP, 2020, 22, 7169-7192.
   • S.Grimme, JCTC, 2019, 15, 2847-2862.

   and for works involving QCG as

   • S.Spicher, C.Plett, P.Pracht, A.Hansen, S.Grimme,
     JCTC, 2022, 18 (5), 3174-3189.
 
   with help from:
   C.Bannwarth, F.Bohle, S.Ehlert, S.Grimme,
   C.Plett, P.Pracht, S.Spicher
 
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

 Command line input:
 &gt; crest fictional.xyz --cinp constraints.inp --subrmsd

  -cinp : constraints.inp

 'constraints.inp' file present.
 content of the constraining file (sorted):
&gt; $constrain
&gt;   atoms: 1-26
&gt;   force constant=0.5
&gt;   reference=coord.ref
&gt; $metadyn
&gt;   atoms: 27-41
 fix file: coord.ref
  atoms: 27-41
     # of atoms considered for RMSDs:15
 
 -------------------------
 xTB Geometry Optimization
 -------------------------
 Geometry successfully optimized.
 
------------------------------------------------
Generating MTD length from a flexibility measure
------------------------------------------------
 Calculating WBOs... done.
 Calculating NCI flexibility... done.
     covalent flexibility measure :   0.555
 non-covalent flexibility measure :   0.778
 flexibility measure :   0.567
 t(MTD) / ps    :     5.0
 Σ(t(MTD)) / ps :    70.0 (14 MTDs)
 
-------------------------------------
Starting a trial MTD to test settings
-------------------------------------
 Trial MTD 1 did not converge!
 Reducing the time step to 4 fs and trying again...
 
 Trial MTD 2 did not converge!
 Reducing the time step to 3 fs and trying again...
 
 Trial MTD 3 did not converge!
 Reducing the time step to 2 fs and trying again...
 
 Estimated runtime for one MTD (5.0 ps) on a single thread: 50 sec
 Estimated runtime for a batch of 14 MTDs on 4 threads: 3 min 21 sec
 
 list of Vbias parameters applied:
$metadyn    0.00300   1.300
$metadyn    0.00150   1.300
$metadyn    0.00075   1.300
$metadyn    0.00300   0.780
$metadyn    0.00150   0.780
$metadyn    0.00075   0.780
$metadyn    0.00300   0.468
$metadyn    0.00150   0.468
$metadyn    0.00075   0.468
$metadyn    0.00300   0.281
$metadyn    0.00150   0.281
$metadyn    0.00075   0.281
$metadyn    0.00100   0.100
$metadyn    0.00500   0.800
 
*******************************************************************************************
**                        N E W    I T E R A T I O N    C Y C L E                        **
*******************************************************************************************

[....]

[....]
 input  file name : crest_rotamers_6.xyz
 output file name : crest_rotamers_7.xyz
 number of atoms                :   41
 atoms included in RMSD         :   15
 number of points on xyz files  :   148
 RMSD threshold                 :   0.1250
 Bconst threshold               :   0.0100
 population threshold           :   0.0500
 conformer energy window  /kcal :   6.0000
 # fragment in coord            :     1
 # bonds in reference structure :    40
 number of reliable points      :   148
 reference state Etot :  -56.0076698600000
 number of doubles removed by rot/RMSD         :           8
 total number unique points considered further :         140
       Erel/kcal        Etot weight/tot  conformer     set   degen     origin
       1   0.000   -56.00767    0.07792    0.15581       1       2     md2
       2   0.000   -56.00767    0.07789                                mtd10
       3   0.139   -56.00745    0.06163    0.12319       2       2     md4
       4   0.140   -56.00745    0.06157                                mtd10
       5   0.289   -56.00721    0.04784    0.04784       3       1     mtd10
       6   0.339   -56.00713    0.04398    0.08793       4       2     mtd10
       7   0.340   -56.00713    0.04395                                md8
       8   0.371   -56.00708    0.04170    0.04170       5       1     mtd9
       9   0.414   -56.00701    0.03875    0.03875       6       1     hor
      10   0.705   -56.00655    0.02373    0.02373       7       1     hor
      11   0.764   -56.00645    0.02147    0.02147       8       1     hor
      12   0.771   -56.00644    0.02124    0.02124       9       1     mtd2
      13   0.797   -56.00640    0.02031    0.02031      10       1     mtd4
      14   0.801   -56.00639    0.02017    0.02017      11       1     mtd10
      15   0.915   -56.00621    0.01665    0.01665      12       1     mtd10
[....]
     138   5.912   -55.99825    0.00000                                gc
     139   5.928   -55.99822    0.00000    0.00000     120       1     hor
     140   5.994   -55.99812    0.00000    0.00000     121       1     gc
T /K                                  :   298.15
E lowest                              :   -56.00767
ensemble average energy (kcal)        :    0.744
ensemble entropy (J/mol K, cal/mol K) :   31.656    7.566
ensemble free energy (kcal/mol)       :   -2.256
population of lowest in %             :   15.581
 number of unique conformers for further calc          121
 list of relative energies saved as "crest.energies"
 
 -----------------
 Wall Time Summary
 -----------------
             test MD wall time :         0h : 0m :15s
                 MTD wall time :         0h : 4m :18s
      multilevel OPT wall time :         0h : 5m :28s
                  MD wall time :         0h : 1m :14s
                  GC wall time :         0h : 1m : 0s
--------------------
Overall wall time  : 0h :12m :24s
</pre></div><button class="copybtn btn fa-solid fa-copy" style="font-size:12px" onclick="copyCode(event)"></button></div></div><script> document.getElementById("open-2").click(); </script><p class="text-justify">A large ensemble of 121 unique conformers was obtained for our fictional system. Inspection of these structures reveals that, indeed, all of them still show a linear conformation of the <em>n</em>-octane chain.</p><h3 id="semi-automated-preparation-of-a-constraint-input"> <a href="#semi-automated-preparation-of-a-constraint-input" class="anchor-heading" aria-labelledby="semi-automated-preparation-of-a-constraint-input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Semi-automated preparation of a constraint input</h3><p>The <code class="language-plaintext highlighter-rouge">constraint.inp</code> file from the <a href="#fixing-of-entire-substructure-parts">previous section <i class="fa-solid fa-circle-up"></i></a> can actually be prepared by CREST. The respective command is</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crest fictional.xyz <span class="nt">--constrain</span> 1-26
</code></pre></div></div><p>Here, the <a href="../documentation/keywords.html#constraining-options"><code class="language-plaintext highlighter-rouge">--constrain &lt;atomlist&gt;</code> command</a> was used, which will simply write a file called <code class="language-plaintext highlighter-rouge">.xcontrol.sample</code> (=<code class="language-plaintext highlighter-rouge">constraints.inp</code> from above). The command will automatically make a copy of the input geometry and name it <code class="language-plaintext highlighter-rouge">coord.ref</code>. All atoms <em>not</em> present in <code class="language-plaintext highlighter-rouge">&lt;atomlist&gt;</code> will be added to the metadynamics bias.</p><hr /><h2 id="automated-bond-constraints"> <a href="#automated-bond-constraints" class="anchor-heading" aria-labelledby="automated-bond-constraints"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Automated bond constraints</h2><p class="text-justify">CREST also has a function for automatically constraining the interatomic distances of all covalent bonds to those from the input structure. This option can be invoked with the <code class="language-plaintext highlighter-rouge">--cbonds</code> command (or its variants, see <a href="../documentation/keywords.html#constraining-options"><strong>Keyword Documentation</strong> <i class="fa-solid fa-book"></i></a>).</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crest struc.xyz <span class="nt">--cbonds</span>
</code></pre></div></div><p class="text-justify">The only drawback here is, that the information whether an interatomic distance corresponds to a covalent bond is approximated from an empirical topology set up from atomic coordination numbers. <strong><em>It can not be ensured that the constrained distances actually correspond to the “true” covalent bonds.</em></strong> Furthermore, metal atoms are often problematic due to their large variety of coordination numbers.</p><hr><footer><p><a href="#top" id="back-to-top">Back to top <i class='fa-solid fa-circle-up'></i></a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022-2023 Joe Gair.</p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
